{"version":3,"sources":["../../src/pages/login-firebase/login-firebase.ts","../../src/pages/login-firebase/login-firebase.module.ts"],"names":[],"mappings":"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","file":"10.js","sourcesContent":["import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, AlertController, ToastController } from 'ionic-angular';\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\n\nimport { AuthService } from './../../providers/auth-service';\n\nimport { User } from '../../models/user';\n\nimport { TabsPage } from '../tabs/tabs';\n\nimport * as firebase from 'firebase';\nimport 'firebase/auth';\nimport { AngularFireAuth } from 'angularfire2/auth';\n\n@IonicPage({\n  name: 'LoginFirebasePage',\n  segment: 'login'\n})\n@Component({\n  selector: 'page-login-firebase',\n  templateUrl: 'login-firebase.html',\n})\nexport class LoginFirebasePage {\n\n  user = {} as User;\n\n  loginForm: FormGroup;\n\n  emailVerified: boolean;\n\n  constructor(public navCtrl: NavController, public navParams: NavParams,\n    public formBuilder: FormBuilder, public authService: AuthService,\n    public afAuth: AngularFireAuth, public alertCtrl: AlertController,\n    public toastCtrl: ToastController) {\n\n    let emailRegex = /^[a-z0-9!#$%&'*+\\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i;\n\n    this.loginForm = this.formBuilder.group({\n      email: ['', Validators.compose([Validators.required, Validators.pattern(emailRegex)])],\n      password: ['', [Validators.required, Validators.minLength(6)]]\n    });\n\n  }\n\n  login(user: User): void{\n\n    let _this = this;\n\n    const alert = this.alertCtrl.create({\n      title: 'Atenção',\n      message: \"Você precisa verificar seu e-mail antes do login! Caso queira receber o e-mail de verificação novamente, clique no botão de Reenviar e-mail\",\n      buttons: [\n        {\n          text: 'Reenviar e-mail',\n          handler: data => {\n            this.authService.sendEmailVerification();\n            }\n          },\n          {\n            text: 'Ok',\n            role: 'cancel'\n          }\n        ]\n    });\n\n    const toast = this.toastCtrl.create({\n      message: 'Erro ao se logar! Verifique se inseriu seu e-mail/senha corretamente',\n      duration: 5000,\n      position: 'top'\n    });\n\n    this.authService.login(user).then(function(user){\n      if(user){\n\n        _this.emailVerified = firebase.auth().currentUser.emailVerified;\n\n        //firebase.auth().onAuthStateChanged(user=>{\n          if(_this.emailVerified == true){\n            _this.navCtrl.setRoot(TabsPage);\n          }else{\n            alert.present();\n            _this.navCtrl.setRoot('LoginFirebasePage');\n          }\n        //})\n      }else{\n        console.log(\"Usuário não existe!\");\n      }\n    }).catch((e)=>{\n      toast.present();\n    });\n  }\n\n  resetPassword(): void{\n\n    const toast = this.toastCtrl.create({\n      message: 'Verifique seu e-mail!',\n      duration: 3000,\n      position: 'top'\n    });\n\n    const alert = this.alertCtrl.create({\n      title: 'Redefinir senha',\n      message: 'Digite seu e-mail cadastrado para receber o link',\n      inputs: [\n        {\n          name: 'email',\n          placeholder: 'E-mail'\n        },\n      ],\n      buttons: [\n        {\n          text: 'Cancelar',\n          role: 'cancel'\n        },\n        {\n          text: 'Ok',\n          handler: data => {\n            this.authService.resetPassword(data.email).then(()=>{\n              toast.present();\n            }).catch(()=>{\n              toast.setMessage('Erro: E-mail não cadastrado');\n              toast.present();\n            })\n          }\n        }\n      ]\n    });\n    alert.present();\n  }\n\n  openRegister(){\n    this.navCtrl.push('RegisterFirebasePage');\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login-firebase/login-firebase.ts","import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { LoginFirebasePage } from './login-firebase';\n\n@NgModule({\n  declarations: [\n    LoginFirebasePage,\n  ],\n  imports: [\n    IonicPageModule.forChild(LoginFirebasePage),\n  ],\n})\nexport class LoginFirebasePageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login-firebase/login-firebase.module.ts"],"sourceRoot":""}